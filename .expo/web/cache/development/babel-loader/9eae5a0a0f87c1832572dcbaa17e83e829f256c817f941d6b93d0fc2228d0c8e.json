{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar AuthContext = createContext(undefined);\nexport var useAuth = function useAuth() {\n  var ctx = useContext(AuthContext);\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\n  return ctx;\n};\nvar STORAGE_KEY = '@tornillofeliz_user';\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      try {\n        var raw = yield AsyncStorage.getItem(STORAGE_KEY);\n        if (raw) setUser(JSON.parse(raw));\n      } catch (e) {\n        console.log('Auth load error', e);\n      }\n    })();\n  }, []);\n  var login = function () {\n    var _ref4 = _asyncToGenerator(function* (_ref3) {\n      var username = _ref3.username,\n        password = _ref3.password;\n      var raw = yield AsyncStorage.getItem(STORAGE_KEY);\n      if (!raw) throw new Error('Usuario no encontrado. Regístrate');\n      var stored = JSON.parse(raw);\n      if (stored.username === username && stored.password === password) {\n        setUser({\n          username: username\n        });\n      } else {\n        throw new Error('Credenciales inválidas');\n      }\n    });\n    return function login(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var register = function () {\n    var _ref6 = _asyncToGenerator(function* (_ref5) {\n      var username = _ref5.username,\n        password = _ref5.password;\n      yield AsyncStorage.setItem(STORAGE_KEY, JSON.stringify({\n        username: username,\n        password: password\n      }));\n      setUser({\n        username: username\n      });\n    });\n    return function register(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var logout = function logout() {\n    return setUser(null);\n  };\n  return _jsx(AuthContext.Provider, {\n    value: {\n      user: user,\n      login: login,\n      register: register,\n      logout: logout\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","AsyncStorage","jsx","_jsx","AuthContext","undefined","useAuth","ctx","Error","STORAGE_KEY","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_asyncToGenerator","raw","getItem","JSON","parse","e","console","log","login","_ref4","_ref3","username","password","stored","_x","apply","arguments","register","_ref6","_ref5","setItem","stringify","_x2","logout","Provider","value"],"sources":["C:/Users/Digitacion Nery/Desktop/TornilloFeliz/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\ntype User = { username: string } | null;\ntype AuthContextType = {\n  user: User;\n  login: (creds: {username: string, password: string}) => Promise<void>;\n  register: (creds: {username: string, password: string}) => Promise<void>;\n  logout: () => void;\n};\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\nexport const useAuth = () => {\n  const ctx = useContext(AuthContext);\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\n  return ctx;\n};\n\nconst STORAGE_KEY = '@tornillofeliz_user';\n\nexport const AuthProvider: React.FC = ({ children }) => {\n  const [user, setUser] = useState<User>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const raw = await AsyncStorage.getItem(STORAGE_KEY);\n        if (raw) setUser(JSON.parse(raw));\n      } catch (e) {\n        console.log('Auth load error', e);\n      }\n    })();\n  }, []);\n\n  const login = async ({ username, password }: {username: string, password: string}) => {\n    const raw = await AsyncStorage.getItem(STORAGE_KEY);\n    if (!raw) throw new Error('Usuario no encontrado. Regístrate');\n    const stored = JSON.parse(raw);\n    if (stored.username === username && stored.password === password) {\n      setUser({ username });\n    } else {\n      throw new Error('Credenciales inválidas');\n    }\n  };\n\n  const register = async ({ username, password }: {username: string, password: string}) => {\n    await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify({ username, password }));\n    setUser({ username });\n  };\n\n  const logout = () => setUser(null);\n\n  return <AuthContext.Provider value={{ user, login, register, logout }}>{children}</AuthContext.Provider>;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}